# 快速排序
快速排序（Quicksort）是对冒泡排序算法的一种改进。

## 排序流程
快速排序算法通过多次比较和交换来实现排序，其排序流程如下：
1. 首先设定一个分界值，通过该分界值将数组分成左右两部分。
2. 将大于或等于分界值的数据集中到数组右边，小于分界值的数据集中到数组的左边。此时，左边部分中各元素都小于或等于分界值，而右边部分中各元素都大于或等于分界值。
3. 然后，左边和右边的数据可以独立排序。对于左侧的数组数据，又可以取一个分界值，将该部分数据分成左右两部分，同样在左边放置较小值，右边放置较大值。右侧的数组数据也可以做类似处理。
4. 重复上述过程，可以看出，这是一个递归定义。通过递归将左侧部分排好序后，再递归排好右侧部分的顺序。当左、右两个部分各数据排序完成后，整个数组的排序也就完成了。

## 优势
综合能力较强的算法，在大部分情况下表现优异（对近乎排序好的数组排序时，不如插入排序）

## 快速排序问题和优化
### 优化1
- 问题：在对近乎排序好的数组进行排序时，效率很差。    
- 原因：最初设计时，分界值设定为子数列的第一个元素，在普通数组中，这没什么问题，但对于一个已经排序好的数组，这就导致排序过程中，几乎所有的元素都被分到了右边，这样就不能体现出快速排序【分治】的效果，这时快速排序会被退化为O(N2)的算法。
- 优化：分界值用随机的方法选取。虽然最差的情况还是很慢，但最差情况发生的概率已经降低到接近于0。

### 优化2
- 问题：在对重复度很高的数组排序时，效率很低。
- 原因：有很多的元素和分界值元素相等时，也会导致一边长一边短的现象，算法也会退化。
- 优化：多加一个指针，把等于分界值的元素集合在中间，这是中间部分相当于已经排序好，下一步只对小于和大于分界值的元素进行排序即可。

## 演示动画
### 对常规数组排序
[查看慢速演示、代码、测试用例](http://sorter.yangtuos.com/?code=%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A+%40param+%7Bnumber%7D+sIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E5%BC%80%E5%A7%8B%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A+%40param+%7Bnumber%7D+eIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9D%9F%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A%2F%0Aconst+partiton+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++if%28eIdx-sIdx+%3C+1%29+return+%5B%5D%3B%0A++list.lines%28%5BsIdx%2CeIdx%2B1%5D%29%3B%0A++let+tIdx+%3D+list.random%28sIdx%2CeIdx%29%3B%0A++%2F%2F+let+tIdx+%3D+sIdx%3B%0A++list.explanation%28%60%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BtIdx%7D%E3%80%91%E5%92%8C%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BsIdx%7D%E3%80%91%E4%BA%A4%E6%8D%A2%E4%BD%8D%E7%BD%AE%60%29%3B%0A++list.swap%28tIdx%2CsIdx%29%3B%0A++tIdx+%3D+sIdx%3B%0A++let+lp+%3D+sIdx+%2B+1%3B%0A++let+rp+%3D+eIdx%3B%0A++let+mp+%3D+lp%3B%0A++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++list.explanation%28%29%3B%0A++while%28true%29%7B%0A++++if%28rp+%3C+mp%29+break%3B%0A++++if%28+list.lt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Clp%29%3B%0A++++++mp%2B%2B%3B%0A++++++lp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28+list.eq%28mp%2CtIdx%29%29%7B%0A++++++mp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28list.gt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Crp%29%3B%0A++++++rp--%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse%7B%0A++++++throw+new+Error%28%22%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF%E4%BA%86%22%29%3B%0A++++%7D%0A++%7D%0A++list.swap%28tIdx%2Clp-1%29%3B%0A++tIdx+%3D+lp-1%3B%0A++list.lines%28%29%3B%0A++list.points%28%29%3B%0A++const+tasts+%3D+%5B%0A++++%7BsIdx%3AsIdx%2CeIdx%3AtIdx-1%7D%2C%0A++++%7BsIdx%3Amp%2CeIdx%3AeIdx%7D%2C%0A++%5D%3B%0A++return+tasts%3B%0A%7D%0A%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A%2F%0Areturn+%28list%29%3D%3E%7B%0A++const+len+%3D+list.length%3B%0A++const+sort+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++++const+res+%3D+partiton%28list%2CsIdx%2CeIdx%29%0A++++for%28let+item+of+res%29%7B%0A++++++sort%28list%2Citem.sIdx%2Citem.eIdx%29%3B%0A++++%7D%0A++%7D%0A++sort%28list%2C0%2Clen-1%29%3B%0A++return+list%3B%0A%7D%0A&case=%5B1%2C8%2C4%2C4%2C9%2C10%2C9%2C2%2C4%2C8%2C6%2C9%2C0%2C5%2C8%2C2%2C2%2C9%2C3%2C9%5D)
![工具地址:http://sorter.yangtuos.com](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-097539ff-f041-4a0d-99fc-4aeb97b53805/9f37f2df-5ea2-4792-a5b7-b468b23c77d8.gif)


### 对近乎排序好的数组排序
[查看慢速演示、代码、测试用例](http://sorter.yangtuos.com/?code=%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A+%40param+%7Bnumber%7D+sIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E5%BC%80%E5%A7%8B%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A+%40param+%7Bnumber%7D+eIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9D%9F%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A%2F%0Aconst+partiton+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++if%28eIdx-sIdx+%3C+1%29+return+%5B%5D%3B%0A++list.lines%28%5BsIdx%2CeIdx%2B1%5D%29%3B%0A++let+tIdx+%3D+list.random%28sIdx%2CeIdx%29%3B%0A++%2F%2F+let+tIdx+%3D+sIdx%3B%0A++list.explanation%28%60%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BtIdx%7D%E3%80%91%E5%92%8C%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BsIdx%7D%E3%80%91%E4%BA%A4%E6%8D%A2%E4%BD%8D%E7%BD%AE%60%29%3B%0A++list.swap%28tIdx%2CsIdx%29%3B%0A++tIdx+%3D+sIdx%3B%0A++let+lp+%3D+sIdx+%2B+1%3B%0A++let+rp+%3D+eIdx%3B%0A++let+mp+%3D+lp%3B%0A++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++list.explanation%28%29%3B%0A++while%28true%29%7B%0A++++if%28rp+%3C+mp%29+break%3B%0A++++if%28+list.lt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Clp%29%3B%0A++++++mp%2B%2B%3B%0A++++++lp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28+list.eq%28mp%2CtIdx%29%29%7B%0A++++++mp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28list.gt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Crp%29%3B%0A++++++rp--%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse%7B%0A++++++throw+new+Error%28%22%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF%E4%BA%86%22%29%3B%0A++++%7D%0A++%7D%0A++list.swap%28tIdx%2Clp-1%29%3B%0A++tIdx+%3D+lp-1%3B%0A++list.lines%28%29%3B%0A++list.points%28%29%3B%0A++const+tasts+%3D+%5B%0A++++%7BsIdx%3AsIdx%2CeIdx%3AtIdx-1%7D%2C%0A++++%7BsIdx%3Amp%2CeIdx%3AeIdx%7D%2C%0A++%5D%3B%0A++return+tasts%3B%0A%7D%0A%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A%2F%0Areturn+%28list%29%3D%3E%7B%0A++const+len+%3D+list.length%3B%0A++const+sort+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++++const+res+%3D+partiton%28list%2CsIdx%2CeIdx%29%0A++++for%28let+item+of+res%29%7B%0A++++++sort%28list%2Citem.sIdx%2Citem.eIdx%29%3B%0A++++%7D%0A++%7D%0A++sort%28list%2C0%2Clen-1%29%3B%0A++return+list%3B%0A%7D%0A&case=%5B0%2C1%2C2%2C3%2C4%2C5%2C6%2C7%2C15%2C9%2C12%2C11%2C17%2C13%2C14%2C8%2C16%2C10%2C18%2C19%5D)
![工具地址:http://sorter.yangtuos.com](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-097539ff-f041-4a0d-99fc-4aeb97b53805/d60748f4-f6ac-49fa-9532-5501a52223a6.gif)


### 对重复度很高的数组排序
[查看慢速演示、代码、测试用例](http://sorter.yangtuos.com/?code=%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A+%40param+%7Bnumber%7D+sIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E5%BC%80%E5%A7%8B%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A+%40param+%7Bnumber%7D+eIdx+%E5%B1%80%E9%83%A8%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9D%9F%E7%B4%A2%E5%BC%95%EF%BC%8C%E9%97%AD%E5%8C%BA%E9%97%B4%0A%2A%2F%0Aconst+partiton+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++if%28eIdx-sIdx+%3C+1%29+return+%5B%5D%3B%0A++list.lines%28%5BsIdx%2CeIdx%2B1%5D%29%3B%0A++let+tIdx+%3D+list.random%28sIdx%2CeIdx%29%3B%0A++%2F%2F+let+tIdx+%3D+sIdx%3B%0A++list.explanation%28%60%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BtIdx%7D%E3%80%91%E5%92%8C%E4%BD%8D%E7%BD%AE%E3%80%90%24%7BsIdx%7D%E3%80%91%E4%BA%A4%E6%8D%A2%E4%BD%8D%E7%BD%AE%60%29%3B%0A++list.swap%28tIdx%2CsIdx%29%3B%0A++tIdx+%3D+sIdx%3B%0A++let+lp+%3D+sIdx+%2B+1%3B%0A++let+rp+%3D+eIdx%3B%0A++let+mp+%3D+lp%3B%0A++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++list.explanation%28%29%3B%0A++while%28true%29%7B%0A++++if%28rp+%3C+mp%29+break%3B%0A++++if%28+list.lt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Clp%29%3B%0A++++++mp%2B%2B%3B%0A++++++lp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28+list.eq%28mp%2CtIdx%29%29%7B%0A++++++mp%2B%2B%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse+if%28list.gt%28mp%2CtIdx%29%29%7B%0A++++++list.swap%28mp%2Crp%29%3B%0A++++++rp--%3B%0A++++++list.points%28%5B%7Bname%3A%22t%22%2Cindex%3AtIdx%7D%2C%7Bname%3A%22l%22%2Cindex%3Alp%7D%2C%7Bname%3A%22m%22%2Cindex%3Amp%7D%2C%7Bname%3A%22r%22%2Cindex%3Arp%7D%5D%29%3B%0A++++%7Delse%7B%0A++++++throw+new+Error%28%22%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF%E4%BA%86%22%29%3B%0A++++%7D%0A++%7D%0A++list.swap%28tIdx%2Clp-1%29%3B%0A++tIdx+%3D+lp-1%3B%0A++list.lines%28%29%3B%0A++list.points%28%29%3B%0A++const+tasts+%3D+%5B%0A++++%7BsIdx%3AsIdx%2CeIdx%3AtIdx-1%7D%2C%0A++++%7BsIdx%3Amp%2CeIdx%3AeIdx%7D%2C%0A++%5D%3B%0A++return+tasts%3B%0A%7D%0A%0A%2F%2A%2A%0A%2A+%40param+%7BSortList%7D+list+%E5%B0%81%E8%A3%85%E8%BF%87%E7%9A%84%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E5%80%BC%EF%BC%8C%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B%0A%2A%2F%0Areturn+%28list%29%3D%3E%7B%0A++const+len+%3D+list.length%3B%0A++const+sort+%3D+%28list%2CsIdx%2CeIdx%29%3D%3E%7B%0A++++const+res+%3D+partiton%28list%2CsIdx%2CeIdx%29%0A++++for%28let+item+of+res%29%7B%0A++++++sort%28list%2Citem.sIdx%2Citem.eIdx%29%3B%0A++++%7D%0A++%7D%0A++sort%28list%2C0%2Clen-1%29%3B%0A++return+list%3B%0A%7D%0A&case=%5B2%2C1%2C2%2C3%2C2%2C0%2C1%2C3%2C3%2C3%2C2%2C2%2C2%2C1%2C3%2C2%2C2%2C1%2C3%2C2%5D)
![工具地址:http://sorter.yangtuos.com](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-097539ff-f041-4a0d-99fc-4aeb97b53805/b21fb643-b453-479e-8229-36a6ef5ad493.gif)
